
Random seed for training set as 2
In total, 25.632185 M # of params
get instruction path: /home/yiqiw2/experiment/language_rl/train_datasets/push_buttons+0
Num ep. 100
get instruction path: /home/yiqiw2/experiment/language_rl/val_datasets/push_buttons+0
Num ep. 10
  0%|                                                                      | 0/400 [00:05<?, ?it/s]
Traceback (most recent call last):
  File "/home/yiqiw2/experiment/language_rl/TemporalLatentGoal/Scripts2/train.py", line 78, in <module>
    training(
  File "/home/yiqiw2/experiment/language_rl/TemporalLatentGoal/Train/training.py", line 104, in training
    pred = agent.model(
  File "/home/yiqiw2/miniconda3/envs/rlnlp/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yiqiw2/experiment/language_rl/TemporalLatentGoal/Networks/models2.py", line 202, in forward
    visual_tokens, residuals, views = self.frontend(rgb, pcd)
  File "/home/yiqiw2/miniconda3/envs/rlnlp/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yiqiw2/experiment/language_rl/TemporalLatentGoal/Networks/frontend.py", line 118, in forward
    return self.tokenize_and_embed(x), enc_feat, N
  File "/home/yiqiw2/experiment/language_rl/TemporalLatentGoal/Networks/frontend.py", line 137, in tokenize_and_embed
    time_emb = self.time_norm(time_emb).squeeze(0)
  File "/home/yiqiw2/miniconda3/envs/rlnlp/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yiqiw2/miniconda3/envs/rlnlp/lib/python3.9/site-packages/torch/nn/modules/normalization.py", line 190, in forward
    return F.layer_norm(
  File "/home/yiqiw2/miniconda3/envs/rlnlp/lib/python3.9/site-packages/torch/nn/functional.py", line 2515, in layer_norm
    return torch.layer_norm(input, normalized_shape, weight, bias, eps, torch.backends.cudnn.enabled)
RuntimeError: Given normalized_shape=[32], expected input with shape [*, 32], but got input of size[1, 6, 512]